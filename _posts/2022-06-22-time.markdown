---
layout : post
title : RBM
date: 2022-06-22
catagories : 
  - Deep learning
tags : 
  - Deep learning
last_modified_at: 2022-06-24
---

## RBM(Restricted Boltzmann Machine)
RBM은 볼츠만 머신에서 층간 연결을 없앤 모델이다.

그러므로 가시층과 은닉층으로 이루어진 비지도학습 신경망 모델이다.

차원감소, 분류, 선형회귀분석, 협업필터링, 특징값 학습, 주제 모델링에 사용될 수 있는 알고리즘이다.

RBM은 심층 신경망 즉, DBN을 구성하는 요소로 사용이 된다. RBM을 여러개 쌓으면 다층 RBM이 아닌 DBN이 된다.

<br></br>
기존의 역전파 신경망과 같이 입력노드에 가중치를 곱한 후 시그노이드 함수를 적용해 은닉층의 값을 구한다.

하지만 역전파 신경망은 시그모이드의 결과값이 출력값이지만, RBM은 확률분포를 이용한다.

<br><br>


## RBM의 구조
![pic3](https://user-images.githubusercontent.com/76985302/175039703-c5ba6c84-e31d-43ff-8d9f-27ce75981f56.png)

왼쪽은 볼츠만 머신이고, 오른쪽은 제한된 볼츠만 머신이다.

BM과 달리 RBM은 층간 연결이 사라진 것을 볼 수 있다.

왼쪽은 가시층으로 입력층을 의미하고, 오른쪽은 은닉층이다.

가시층의 노드에서는 입력받은 데이터를 은닉층에 얼만큼 전달할 것인지 확률에 따라 결정한다.

<br><br>

## RBM의 학습

![RMB](https://user-images.githubusercontent.com/76985302/175485125-d945912a-744f-4fc8-9838-ffec1e36d76b.PNG)
위 그림과 같이 가중치가 주어졌을때, 가시층으로부터 은닉층의 확률을 추정한다.

그리고 은닉층으로부터 가시층의 확률을 추정한다. 이렇게 두 분포를 유사하게 만들고, 두 값이 같아질 때까지 반복한다.

두 분포가 같은지에 대한 측정방법은 KLD를 사용한다.

<br>
두 분포가 다른 부분을 "발산"이라고 한다.

이 발산을 최소화하는 알고리즘이 최적의 알고리즘이다.

<br><br>


## RMB의 에너지

가시층과 은닉층에 따라서 에너지를 결정한다.

에너지 함수는 학습을 평가하는데 쓰인다. cost function과 같은 것이다.

에너지가 낮을수록 학습이 더 잘된 것이라고 볼 수 있다.

<br><br>


## RBM의 가중치

가중치는 에너지를 최소화하는 방향으로 갱신이 된다.

가중치의 갱신은 경사하강법으로 이루어진다.

<br>
학습은 가시층을 이용해 은닉층의 데이터를 샘플링하기도 하고, 그 반대로 하기도 한다.

이를 이용해 조건부 확률을 구해 학습이 진행이 된다.

가시층과 은닉층은 0과 1의 값을 가지고, sigmoid 함수를 활용하여 학습을 한다.

<br>
경사하강법을 이용해서 확인해보면 샘플링을 통해 얻은 가시층의 데이터가 원래 가시층의 데이터와 같은 경우에 loss가 낮아진다.

<br><br>


## RBM의 CD

Contrastive Divergence는 가시층의 데이터로 은닉층을 샘플링하고 그 데이터로 다시 가시층의 데이터를 예측하는 과정에서 그 차이를 보는 것이다.

<br>
샘플링 과정은 MCMC의 방법 중 하나인 깁스샘플링을 이용한다.

학습이 잘 된 것은 likelihood가 최대화 된 것이다. 이를 최대화 시키기 위해 경사하강법을 사용한다.

결국은 모든 학습은 likelihood의 비교가 된다.


<br><br>

---
- 참고문헌

<https://koreapy.tistory.com/1223>

<http://www.tcpschool.com/deeplearning/deep_algorithm3>

<https://tbacking.com/2016/12/10/rbm-%EC%A0%9C%ED%95%9C%EB%90%9C-%EB%B3%BC%EC%B8%A0%EB%A7%8C-%EB%A8%B8%EC%8B%A0-%EC%9D%B4%ED%95%B4/>

<https://angeloyeo.github.io/2020/10/02/RBM.html>
